<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-01-21">

<title>Lab 2 – 432-2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">432-2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./calendar.html"> 
<span class="menu-text">Calendar</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./tocome.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://thomaselove.github.io/432-notes/"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/THOMASELOVE/432-data"> 
<span class="menu-text">Get Data</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-labs" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Labs</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-labs">    
        <li>
    <a class="dropdown-item" href="./lab1.html">
 <span class="dropdown-text">Lab 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab2.html">
 <span class="dropdown-text">Lab 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab3.html">
 <span class="dropdown-text">Lab 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab4.html">
 <span class="dropdown-text">Lab 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab5.html">
 <span class="dropdown-text">Lab 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab6.html">
 <span class="dropdown-text">Lab 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab7.html">
 <span class="dropdown-text">Lab 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./lab8.html">
 <span class="dropdown-text">Lab 8</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-projects" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Projects</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-projects">    
        <li>
    <a class="dropdown-item" href="./projA.html">
 <span class="dropdown-text">Project A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./projB.html">
 <span class="dropdown-text">Project B</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-quizzes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Quizzes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-quizzes">    
        <li>
    <a class="dropdown-item" href="./quiz1.html">
 <span class="dropdown-text">Quiz 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./quiz2.html">
 <span class="dropdown-text">Quiz 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/THOMASELOVE/432-sources"> 
<span class="menu-text">Sources</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-key-links" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Key Links</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-key-links">    
        <li>
    <a class="dropdown-item" href="https://campuswire.com/">
 <span class="dropdown-text">Campuswire discussion board</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://canvas.case.edu/">
 <span class="dropdown-text">Canvas (submissions &amp; recordings)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tocome.html">
 <span class="dropdown-text">Shared Google Drive</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tocome.html">
 <span class="dropdown-text">Minute Papers (Github)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tocome.html">
 <span class="dropdown-text">Class READMEs (Github)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./contact.html"> 
<span class="menu-text">Contact Us</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#general-instructions" id="toc-general-instructions" class="nav-link active" data-scroll-target="#general-instructions">General Instructions</a>
  <ul class="collapse">
  <li><a href="#template" id="toc-template" class="nav-link" data-scroll-target="#template">Template</a></li>
  <li><a href="#our-best-advice" id="toc-our-best-advice" class="nav-link" data-scroll-target="#our-best-advice">Our Best Advice</a></li>
  </ul></li>
  <li><a href="#question-1-25-points" id="toc-question-1-25-points" class="nav-link" data-scroll-target="#question-1-25-points">Question 1 (25 points)</a>
  <ul class="collapse">
  <li><a href="#data-for-question-1" id="toc-data-for-question-1" class="nav-link" data-scroll-target="#data-for-question-1">Data for Question 1</a></li>
  <li><a href="#variables-studied-in-question-1" id="toc-variables-studied-in-question-1" class="nav-link" data-scroll-target="#variables-studied-in-question-1">Variables Studied in Question 1</a></li>
  <li><a href="#loading-the-question-1-data" id="toc-loading-the-question-1-data" class="nav-link" data-scroll-target="#loading-the-question-1-data">Loading the Question 1 Data</a></li>
  </ul></li>
  <li><a href="#question-2-25-points" id="toc-question-2-25-points" class="nav-link" data-scroll-target="#question-2-25-points">Question 2 (25 points)</a>
  <ul class="collapse">
  <li><a href="#question-2-hints" id="toc-question-2-hints" class="nav-link" data-scroll-target="#question-2-hints">Question 2 Hints</a></li>
  <li><a href="#data-for-question-2-hbp3456-data" id="toc-data-for-question-2-hbp3456-data" class="nav-link" data-scroll-target="#data-for-question-2-hbp3456-data">Data for Question 2 (<code>hbp3456</code> data)</a>
  <ul class="collapse">
  <li><a href="#eligibility-criteria" id="toc-eligibility-criteria" class="nav-link" data-scroll-target="#eligibility-criteria">Eligibility Criteria</a></li>
  <li><a href="#codebook" id="toc-codebook" class="nav-link" data-scroll-target="#codebook">Codebook</a></li>
  <li><a href="#notes-on-specific-variables" id="toc-notes-on-specific-variables" class="nav-link" data-scroll-target="#notes-on-specific-variables">Notes on Specific Variables</a></li>
  </ul></li>
  <li><a href="#loading-the-data-for-question-2" id="toc-loading-the-data-for-question-2" class="nav-link" data-scroll-target="#loading-the-data-for-question-2">Loading the Data for Question 2</a></li>
  </ul></li>
  <li><a href="#use-of-ai" id="toc-use-of-ai" class="nav-link" data-scroll-target="#use-of-ai">Use of AI</a></li>
  <li><a href="#include-the-session-information" id="toc-include-the-session-information" class="nav-link" data-scroll-target="#include-the-session-information">Include the Session Information</a>
  <ul class="collapse">
  <li><a href="#after-the-lab" id="toc-after-the-lab" class="nav-link" data-scroll-target="#after-the-lab">After the Lab</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 2</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2024-01-21</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="general-instructions" class="level1">
<h1>General Instructions</h1>
<ul>
<li>Submit your work via <a href="https://canvas.case.edu/">Canvas</a>.</li>
<li>The deadline for this Lab is specified on the Course <a href="./calendar.html">Calendar</a>.
<ul>
<li>Work submitted more than 59 minutes late, but within 12 hours of the deadline will lose 5 of the available 50 points.</li>
<li>Work submitted 12 to 24 hours after the deadline will lose 10 of the available 50 points.</li>
<li>Work submitted more than 24 hours after the deadline will not be graded.</li>
</ul></li>
</ul>
<p>Your response should include a Quarto file (.qmd) and an HTML document that is the result of applying your Quarto file to the data we’ve provided.</p>
<section id="template" class="level2">
<h2 class="anchored" data-anchor-id="template">Template</h2>
<p>There is a <a href="https://raw.githubusercontent.com/THOMASELOVE/432-data/master/templates/lab2_template.qmd">Lab 2 Quarto template</a> available on <a href="https://github.com/THOMASELOVE/432-data">our 432-data page</a>. Please use the template to prepare your response to Lab 2, as it will make things easier for you and for the people grading your work. The template is quite generic, and can also be used for other work, including Labs 3-8.</p>
</section>
<section id="our-best-advice" class="level2">
<h2 class="anchored" data-anchor-id="our-best-advice">Our Best Advice</h2>
<p>Review your HTML output file carefully before submission for copy-editing issues (spelling, grammar and syntax.) Even with spell-check in RStudio (just hit F7), it’s hard to find errors with these issues in your Quarto file so long as it is running. You really need to look closely at the resulting HTML output.</p>
</section>
</section>
<section id="question-1-25-points" class="level1">
<h1>Question 1 (25 points)</h1>
<p>Question 1 uses the <code>lab2q1</code> data, based on NHANES 2017-18 results. You will use these data to generate two different responses to the question:</p>
<blockquote class="blockquote">
<p>Estimate the percentage of the US non-institutionalized adult population within the ages of 21-49 who engage in moderate-activity sports that would describe their General Health as either “Excellent” or “Very Good”.</p>
</blockquote>
<ol type="a">
<li><p>(10 points) What percentage of the subjects who responded “Yes” to the moderate-intensity sports question included in the <code>lab2q1</code> data have described their General Health as either “Excellent” or “Very Good”, among those who provided an answer to the General Health question? Be sure to use a <strong>complete-case</strong> analysis to deal with missing data on the General Health variable, and provide all of the R code you use to obtain your result, annotated with detailed text that makes it clear what you are doing as you proceed. Please express your final response as a percentage between 0 and 100, including a single decimal place.</p></li>
<li><p>(15 points) Please answer the question asked in Question 1a, again, but this time accounting for the sampling weights used in <code>wtint2yr</code>, again using a <strong>complete-case</strong> analysis to deal with missing General Health values. As you did in Question 1a, provide all of the R code you use to obtain your result, annotated with text to make it clear what you are doing, and then express your final response to Question 1b as a percentage, again including a single decimal place.</p></li>
</ol>
<section id="data-for-question-1" class="level2">
<h2 class="anchored" data-anchor-id="data-for-question-1">Data for Question 1</h2>
<p>Dr.&nbsp;Love created these data from NHANES 2017-18 Demographics and Questionnaire data, using the code below.</p>
<p>Specifically, he used the <code>DEMO_J</code> (Demographics) and <code>HSQ_J</code> (Current Health Status) files, which are described at <a href="https://wwwn.cdc.gov/nchs/nhanes/ContinuousNhanes/Default.aspx?BeginYear=2017">this link</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nhanesA)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>temp1 <span class="ot">&lt;-</span> <span class="fu">nhanes</span>(<span class="st">'DEMO_J'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>temp2 <span class="ot">&lt;-</span> <span class="fu">nhanes</span>(<span class="st">'HSQ_J'</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>temp3 <span class="ot">&lt;-</span> <span class="fu">nhanes</span>(<span class="st">'PAQ_J'</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>temp12 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(temp1, temp2, <span class="at">by =</span> <span class="st">"SEQN"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>temp123 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(temp12, temp3, <span class="at">by =</span> <span class="st">"SEQN"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>lab2q1 <span class="ot">&lt;-</span> temp123 <span class="sc">|&gt;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SEQN, WTINT2YR, RIDAGEYR, HSD010, PAQ665) <span class="sc">|&gt;</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RIDAGEYR <span class="sc">&gt;</span> <span class="dv">20</span> <span class="sc">&amp;</span> RIDAGEYR <span class="sc">&lt;</span> <span class="dv">50</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PAQ665 <span class="sc">&lt;</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HSD010 =</span> <span class="fu">factor</span>(HSD010),</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">PAQ665 =</span> <span class="fu">factor</span>(PAQ665),</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">SEQN =</span> <span class="fu">as.character</span>(SEQN)) <span class="sc">|&gt;</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>()</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(temp1, temp12, temp2, temp3, temp123)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lab2q1, <span class="at">file =</span> <span class="st">"data/lab2q1.Rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="variables-studied-in-question-1" class="level2">
<h2 class="anchored" data-anchor-id="variables-studied-in-question-1">Variables Studied in Question 1</h2>
<p>The resulting variables are listed below.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 20%">
<col style="width: 68%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Item</th>
<th style="text-align: center;">Description</th>
<th>Possible Responses</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>seqn</code></td>
<td style="text-align: center;">Subject id code</td>
<td>93717 through 102956</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>wtint2yr</code></td>
<td style="text-align: center;">Full sample 2 year interview weight</td>
<td>min = 4363, max = 387879</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>ridageyr</code></td>
<td style="text-align: center;">Age in years at screening</td>
<td>min = 21, max = 49</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>hsd010</code></td>
<td style="text-align: center;">General Health Condition</td>
<td>see below</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>paq665</code></td>
<td style="text-align: center;">Moderate Recreational Activities</td>
<td>see below</td>
</tr>
</tbody>
</table>
<ul>
<li><code>hsd010</code> Would you say your health in general is
<ul>
<li>1 = Excellent,</li>
<li>2 = Very Good,</li>
<li>3 = Good,</li>
<li>4 = Fair, or</li>
<li>5 = Poor?</li>
<li>(Note that 7 = Refused, 9 = Don’t know in this variable, which we will treat as missing.)</li>
</ul></li>
<li><code>paq665</code> Do you do any moderate-intensity sports, fitness, or recreational activities that cause a small increase in breathing or heart rate such as brisk walking, bicycling, swimming, or golf for at least 10 minutes continuously?
<ul>
<li>1 = Yes, 2 = No</li>
</ul></li>
</ul>
</section>
<section id="loading-the-question-1-data" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-question-1-data">Loading the Question 1 Data</h2>
<p>I have provided the saved <code>lab2q1.Rds</code> file to you on <a href="https://github.com/THOMASELOVE/432-data">the 432-data page</a>. I encourage you to load it using the code below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="cn">NA</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>lab2q1 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"https://raw.githubusercontent.com/THOMASELOVE/432-data/master/data/lab2q1.Rds"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>lab2q1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,295 × 5
   seqn  wtint2yr ridageyr hsd010 paq665
   &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt; 
 1 93717   53249.       22 2      2     
 2 93718   20257.       45 3      1     
 3 93729   11760.       42 4      2     
 4 93738   59333.       26 3      2     
 5 93746   27135.       25 2      2     
 6 93755   30922.       26 2      1     
 7 93761   18939.       44 3      2     
 8 93763  103670.       40 3      1     
 9 93766   16414.       36 4      2     
10 93774  232377.       41 &lt;NA&gt;   1     
# ℹ 2,285 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="question-2-25-points" class="level1">
<h1>Question 2 (25 points)</h1>
<p>Question 2 uses the <code>hbp3456</code> data.</p>
<ol type="a">
<li><p>(10 points) Does which <strong>insurance</strong> status a person has seem to have a meaningful impact on their <strong>systolic blood pressure</strong>, adjusting for whether or not they have a prescription for a <strong>beta-blocker</strong>? Decide whether your model should include an interaction term in a sensible way (providing a graph to help us understand your reasoning), and then fit your choice of model using the <code>lm</code> function in R. Display your results.</p></li>
<li><p>(15 points) Provide a written explanation of your findings, in complete sentences. Your explanation should address both the overall quality of fit and the interpretation of the coefficients of your chosen model, as well as provide a detailed description as to how you used the output you generated in part a to decide whether or not to include an interaction term.</p></li>
</ol>
<section id="question-2-hints" class="level2">
<h2 class="anchored" data-anchor-id="question-2-hints">Question 2 Hints</h2>
<ol type="1">
<li>One graph you might use would be one to assess the need for an interaction term, probably via a plot of means.</li>
<li>Another graph (or perhaps table) to consider for insight would look at the relationship between <strong>insurance</strong> and <strong>beta-blocker</strong> status in these subjects.</li>
<li>Please explicitly state in your response that you assume that the missingness you observe in these data are MCAR, and that a complete case analysis is thus appropriate for this Question.</li>
</ol>
</section>
<section id="data-for-question-2-hbp3456-data" class="level2">
<h2 class="anchored" data-anchor-id="data-for-question-2-hbp3456-data">Data for Question 2 (<code>hbp3456</code> data)</h2>
<p>The (simulated) data in the <code>hbp3456.csv</code> file describe a total of 3456 people living with hypertension (high blood pressure) diagnoses who receive primary care in one of eight practices.</p>
<ul>
<li>In each of the eight practices, 432 (different) individuals (who I’ll call subjects in what follows) were sampled at random from all eligible subjects.</li>
<li>The data are based on real electronic health record (EHR) data, but with some noise added.
<ul>
<li>The practices are named after streets that appear in <em>The Simpsons</em>.</li>
<li>There are 62 (fictional) providers identified across the eight practices, and each provider cares for subjects within a single practice.</li>
</ul></li>
</ul>
<section id="eligibility-criteria" class="level3">
<h3 class="anchored" data-anchor-id="eligibility-criteria">Eligibility Criteria</h3>
<p>The data are cross-sectional and describe results from a one-year reporting window. To be eligible for the study, a subject had to meet all of the following criteria:</p>
<ul>
<li>have an EHR-documented hypertension diagnosis which applied during the one-year reporting window,</li>
<li>cared for at one of the eight practices in this study, and by one of the 62 participating providers in this study</li>
<li>age 25 or older at the start of the one-year reporting period (note that all subjects with ages 80 and higher are listed as age 80 in the data)</li>
<li>between 1 and 12 primary care office visits in the one-year reporting period</li>
<li>between 2 and 24 primary care office visits combined across the reporting period and the previous year</li>
<li>fall into one of two biological sex categories (female or male)</li>
<li>fall into one of four primary insurance categories, specifically Medicare, Commercial, Medicaid or Uninsured.</li>
<li>have a most recent systolic BP between 80 and 220 mm Hg and most recent diastolic BP between 40 and 140 mm Hg, where the systolic BP is at least 15 and no more than 130 mm Hg larger than the diastolic BP.</li>
</ul>
</section>
<section id="codebook" class="level3">
<h3 class="anchored" data-anchor-id="codebook">Codebook</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 90%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><code>record</code></td>
<td>unique code for each subject (six digits, first digit is 9, last indicates practice)</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>practice</code></td>
<td>primary care practice, of which there are eight in the data</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>provider</code></td>
<td>primary care provider (each practice has multiple providers)</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>age</code></td>
<td>subject’s age as of the start of the reporting period</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>race</code></td>
<td>subject’s race (4 levels: Asian, AA_Black, White, Other)</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>eth_hisp</code></td>
<td>is subject of Hispanic/Latino ethnicity? Yes or No</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>sex</code></td>
<td>subject’s sex (F or M)</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>insurance</code></td>
<td>subject’s primary insurance (Medicare, Commercial, Medicaid, Uninsured)</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>income</code></td>
<td>estimated median income of subject’s home neighborhood (via American Community Survey, to nearest $100)</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>hsgrad</code></td>
<td>estimated percentage of adults living in the subject’s home neighborhood who have graduated from high school (via American Community Survey, to the nearest tenth of a percent)</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>tobacco</code></td>
<td>tobacco use status (Current, Former, or Never)</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>depr_diag</code></td>
<td>does subject have depression diagnosis? Yes or No</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>height</code></td>
<td>subject’s height in meters, rounded to two decimal places</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>weight</code></td>
<td>subject’s weight in kilograms, rounded to one decimal place</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>ldl</code></td>
<td>subject’s LDL cholesterol level, in mg/dl</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>statin</code></td>
<td>does subject have a current prescription for a statin medication? Yes or No</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>bp_med</code></td>
<td>does subject have a current prescription for a blood pressure control medication? Yes or No</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>sbp</code></td>
<td>subject’s most recently obtained systolic blood pressure, in mm Hg</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>dbp</code></td>
<td>subject’s most recently obtained diastolic blood pressure, in mm Hg</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>visits_1</code></td>
<td>subject’s number of visits for primary care in reporting period (one year)</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>visits_2</code></td>
<td>subject’s visits for primary care in the past two years</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>acearb</code></td>
<td>does subject have a current prescription for an ACE-inhibitor or ARB? Yes or No</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>betab</code></td>
<td>does subject have a current prescription for a beta-blocker? Yes or No</td>
</tr>
</tbody>
</table>
</section>
<section id="notes-on-specific-variables" class="level3">
<h3 class="anchored" data-anchor-id="notes-on-specific-variables">Notes on Specific Variables</h3>
<ul>
<li>The list of medications included in <code>bp_med</code> is: ACE-inhibitor, ARB, Diuretic, Calcium-Channel Blocker, Beta-Blocker, Alpha-1 Blocker, Centrally acting Alpha-2 Agonist, Vasodilator or other antihypertensive agents. A subject with a current prescription for any of these will have a Yes in <code>bp_med</code>.</li>
<li>For the <code>acearb</code>, <code>betab</code>, <code>bpmed</code>, <code>statin</code> and <code>depr_diag</code> variables, a No response includes all subjects where there’s no evidence in the EHR of meeting the Yes criterion, so that there are no missing values (a missing value is interpreted there as No.)</li>
<li>For the <code>height</code>, <code>weight</code> and <code>ldl</code> results, implausible values were treated as missing in preparing the data for you.</li>
<li>The <code>race</code> and <code>eth_hisp</code> values are self-reported, and some subjects refused to answer one or both of the relevant questions.</li>
<li>The <code>income</code> and <code>hsgrad</code> values are imputed from the subject’s home address, usually at the census block level, but occasionally at the level of the zip code.
<ul>
<li>When a subject’s home address could not be geocoded, these values are noted as missing.</li>
<li>Geocoded estimates of <code>income</code> below 6500 are reported as 6500, and estimates above 130000 are reported as 130000.</li>
<li>For <code>hsgrad</code>, geocoded estimates below 40 are reported as 40, and estimates above 99.9 are reported as 99.9.</li>
</ul></li>
</ul>
</section>
</section>
<section id="loading-the-data-for-question-2" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-data-for-question-2">Loading the Data for Question 2</h2>
<p>Here’s the approach I took to load and view the <code>hbp3456</code> data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="cn">NA</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>hbp3456 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/THOMASELOVE/432-data/master/data/hbp3456.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">record =</span> <span class="fu">as.character</span>(record))</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>hbp3456</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,456 × 23
   record practice provider   age race    eth_hisp sex   insurance income hsgrad
   &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;
 1 900018 Walnut   W_05        64 &lt;NA&gt;    &lt;NA&gt;     F     Medicare   15600   83  
 2 900024 King     K_07        74 AA_Bla… No       F     Medicare   16200   92.8
 3 900037 Sycamore S_06        60 AA_Bla… No       F     Commerci…  21400   79  
 4 900043 Highland H_07        46 White   Yes      F     Medicaid   38300   83.5
 5 900057 Sycamore S_04        59 AA_Bla… No       M     Commerci…  23200   78.7
 6 900062 Elm      E_03        54 AA_Bla… No       M     Commerci…  48600   85.5
 7 900076 Plympton P_03        74 White   No       M     Commerci…  64200   92.9
 8 900082 Elm      E_06        73 White   No       M     Medicare   48600   85.5
 9 900097 Sycamore S_10        58 AA_Bla… No       F     Commerci…  29900   86.2
10 900101 Center   C_01        46 AA_Bla… No       M     Uninsured  63600   97.5
# ℹ 3,446 more rows
# ℹ 13 more variables: tobacco &lt;chr&gt;, depr_diag &lt;chr&gt;, height &lt;dbl&gt;,
#   weight &lt;dbl&gt;, ldl &lt;dbl&gt;, statin &lt;chr&gt;, bp_med &lt;chr&gt;, sbp &lt;dbl&gt;, dbp &lt;dbl&gt;,
#   visits_1 &lt;dbl&gt;, visits_2 &lt;dbl&gt;, acearb &lt;chr&gt;, betab &lt;chr&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="use-of-ai" class="level1">
<h1>Use of AI</h1>
<p>If you decide to use some sort of AI to help you with this Lab, we ask that you place a note to that effect, describing what you used and how you used it, as a separate section called “Use of AI”, after your answers to our questions, and just <em>before</em> your presentation of the Session Information. Thank you.</p>
</section>
<section id="include-the-session-information" class="level1">
<h1>Include the Session Information</h1>
<p>Please display your session information at the end of your submission, as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>xfun<span class="sc">::</span><span class="fu">session_info</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.2 (2024-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 11 x64 (build 22631)

Locale:
  LC_COLLATE=English_United States.utf8 
  LC_CTYPE=English_United States.utf8   
  LC_MONETARY=English_United States.utf8
  LC_NUMERIC=C                          
  LC_TIME=English_United States.utf8    

Package version:
  askpass_1.2.1       backports_1.5.0     base64enc_0.1.3    
  bit_4.5.0.1         bit64_4.5.2         blob_1.2.4         
  broom_1.0.7         bslib_0.8.0         cachem_1.1.0       
  callr_3.7.6         cellranger_1.1.0    cli_3.6.3          
  clipr_0.8.0         colorspace_2.1-1    compiler_4.4.2     
  conflicted_1.2.0    cpp11_0.5.1         crayon_1.5.3       
  curl_6.0.1          data.table_1.16.4   DBI_1.2.3          
  dbplyr_2.5.0        digest_0.6.37       dplyr_1.1.4        
  dtplyr_1.3.1        evaluate_1.0.1      fansi_1.0.6        
  farver_2.1.2        fastmap_1.2.0       fontawesome_0.5.3  
  forcats_1.0.0       fs_1.6.5            gargle_1.5.2       
  generics_0.1.3      ggplot2_3.5.1       glue_1.8.0         
  googledrive_2.1.1   googlesheets4_1.1.1 graphics_4.4.2     
  grDevices_4.4.2     grid_4.4.2          gtable_0.3.6       
  haven_2.5.4         highr_0.11          hms_1.1.3          
  htmltools_0.5.8.1   htmlwidgets_1.6.4   httr_1.4.7         
  ids_1.0.1           isoband_0.2.7       janitor_2.2.1      
  jquerylib_0.1.4     jsonlite_1.8.9      knitr_1.49         
  labeling_0.4.3      lattice_0.22.6      lifecycle_1.0.4    
  lubridate_1.9.4     magrittr_2.0.3      MASS_7.3.61        
  Matrix_1.7.1        memoise_2.0.1       methods_4.4.2      
  mgcv_1.9.1          mime_0.12           modelr_0.1.11      
  munsell_0.5.1       nlme_3.1.166        openssl_2.3.0      
  parallel_4.4.2      pillar_1.10.0       pkgconfig_2.0.3    
  prettyunits_1.2.0   processx_3.8.4      progress_1.2.3     
  ps_1.8.1            purrr_1.0.2         R6_2.5.1           
  ragg_1.3.3          rappdirs_0.3.3      RColorBrewer_1.1.3 
  readr_2.1.5         readxl_1.4.3        rematch_2.0.0      
  rematch2_2.1.2      reprex_2.1.1        rlang_1.1.4        
  rmarkdown_2.29      rstudioapi_0.17.1   rvest_1.0.4        
  sass_0.4.9          scales_1.3.0        selectr_0.4.2      
  snakecase_0.11.1    splines_4.4.2       stats_4.4.2        
  stringi_1.8.4       stringr_1.5.1       sys_3.4.3          
  systemfonts_1.1.0   textshaping_0.4.1   tibble_3.2.1       
  tidyr_1.3.1         tidyselect_1.2.1    tidyverse_2.0.0    
  timechange_0.3.0    tinytex_0.54        tools_4.4.2        
  tzdb_0.4.0          utf8_1.2.4          utils_4.4.2        
  uuid_1.2.1          vctrs_0.6.5         viridisLite_0.4.2  
  vroom_1.6.5         withr_3.0.2         xfun_0.49          
  xml2_1.3.6          yaml_2.3.10        </code></pre>
</div>
</div>
<section id="after-the-lab" class="level2">
<h2 class="anchored" data-anchor-id="after-the-lab">After the Lab</h2>
<p>We will post an answer sketch 24 hours after the Lab is due.</p>
<p>We will post grades to our Grading Roster on our Shared Google Drive one week after the Lab is due.</p>
<p>See the <a href="https://thomaselove.github.io/432-syllabus-2024/08-grading.html#lab-appeal-policy---request-a-review-via-google-form">Lab Appeal Policy in our Syllabus</a> if you are interested in having your Lab grade reviewed, and use <a href="https://bit.ly/432-2024-lab-regrades">the Lab Regrade Request form specified there</a> to complete the task. Thank you.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>